<html>
	<head>
		<style>
			body { margin: 0; padding: 0; border: 0; background-color: #ffffff; }
			iframe { width: 100%; height: 100%; border: 0; background-color: transparent; }
		</style>
	</head>
	<body>
		<iframe id="main"></iframe>
		<!--scripts-->
		<script type="text/javascript">
			const mainEl = document.getElementById('main'),
						codeStr = window.location.search.replace('?codeString=', '');
						
			if (
				codeStr.startsWith('https:') && 
				codeStr.includes('blobs')
			) {
				async function getBlobCode() {
					const blobCode = await fetch(
						'https://us-central1-my-website-b71e9.cloudfunctions.net/code_preview', 
						{
							method: 'POST',
							mode: 'cors',
							headers: {
								'Access-Control-Allow-Origin': '*',
								'Content-Type': 'application/json'
							},
							body: JSON.stringify({ 
								data: codeStr 
							})
						}
					).then(res => {
						return res.text();
					}).then(data => {
						return data;
					}).catch(err => {
						console.error(err);
						return err;
					});

					mainEl.srcdoc = blobCode;
				}

				getBlobCode();
			} else {
				mainEl.srcdoc = decodeURIComponent(codeStr);
			}
		</script>
		<!--//scripts-->
	</body>
</html>